(this["webpackJsonptraffic-editor-pwa"]=this["webpackJsonptraffic-editor-pwa"]||[]).push([[0],{134:function(e,t,n){},147:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),o=n(26),c=n.n(o),l=(n(134),n(202)),u=n(224),s=n(12),d=n(1),f=n(2),v=n(5),m=n(6),j=n(86),b=n(105),p=n(7),x=n(226),h=n(24),O=function(){function e(){Object(d.a)(this,e),this.type_idx=0,this.name="",this.value=0,this.uuid=""}return Object(f.a)(e,null,[{key:"fromYAML",value:function(t,n){var a=new e;return a.name=t,a.type_idx=n[0],a.value=n[1],a.uuid=Object(x.a)(),a}}]),e}(),y=function(){function e(){Object(d.a)(this,e),this.uuid="",this.params=[],this.props=[],this.object_type_name=""}return Object(f.a)(e,[{key:"paramsFromYAML",value:function(e){for(var t in e)this.params.push(O.fromYAML(t,e[t]))}},{key:"paramsToYAML",value:function(){var e,t=new h.a.YAMLMap,n=Object(s.a)(this.params);try{for(n.s();!(e=n.n()).done;){var a=e.value,r=new h.a.YAMLSeq;r.add(a.type_idx),r.add(a.value),r.flow=!0,t.add({key:a.name,value:r})}}catch(i){n.e(i)}finally{n.f()}return t.flow=!0,t}}],[{key:"roundNicely",value:function(e){return Math.round(1e3*e)/1e3}}]),e}(),g=n(15),w=function e(t,n){Object(d.a)(this,e),this.name="",this.get_value=function(){return""},this.set_value=function(e){},this.uuid="",this.name=t,this.get_value=n,this.uuid=Object(x.a)()},M=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).x=0,e.y=0,e.name="",e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLSeq;return e.add(this.x),e.add(-this.y),e.add(0),e.add(this.name),this.params.length&&e.add(this.paramsToYAML()),e.flow=!0,e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.object_type_name="Vertex",t.uuid=Object(x.a)(),t.x=e[0],t.y=-e[1],t.name=e[3],t.paramsFromYAML(e[4]),t.props.push(new w("name",(function(){return t.name}))),t.props.push(new w("x",(function(){return y.roundNicely(t.x)}))),t.props.push(new w("y",(function(){return y.roundNicely(t.y)}))),t}}]),n}(y),_=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="",e.x=0,e.y=0,e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLMap;return e.add({key:"id",value:this.uuid}),e.add({key:"name",value:this.name}),e.add({key:"x",value:this.x}),e.add({key:"y",value:-this.y}),e.flow=!0,e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.object_type_name="Feature",t.uuid=e.id,t.name=e.name,t.x=e.x,t.y=-e.y,t.props.push(new w("name",(function(){return t.name}))),t.props.push(new w("x",(function(){return y.roundNicely(t.x)}))),t.props.push(new w("y",(function(){return y.roundNicely(t.y)}))),t}}]),n}(y),k=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="",e.elevation=0,e.scale=1.234,e.doors=[],e.vertices=[],e.walls=[],e.measurements=[],e.floors=[],e.lanes=[],e.models=[],e.images=[],e.features=[],e.constraints=[],e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLMap;e.add({key:"constraints",value:this.constraints.map((function(e){return e.toYAML()}))}),e.add({key:"doors",value:this.doors.map((function(e){return e.toYAML()}))}),this.images.length>0&&this.images[0].isLegacyDefaultImage&&e.add({key:"drawing",value:{filename:this.images[0].filename}}),e.add({key:"elevation",value:this.elevation}),e.add({key:"features",value:this.features.map((function(e){return e.toYAML()}))}),e.add({key:"flattened_x_offset",value:0}),e.add({key:"flattened_y_offset",value:0}),e.add({key:"floors",value:this.floors.map((function(e){return e.toYAML()}))}),e.add({key:"lanes",value:this.lanes.map((function(e){return e.toYAML()}))});var t,n=new h.a.YAMLMap,a=Object(s.a)(this.images);try{for(a.s();!(t=a.n()).done;){var r=t.value;r.isLegacyDefaultImage||n.add({key:r.name,value:r.toLayerYAML()})}}catch(i){a.e(i)}finally{a.f()}return e.add({key:"layers",value:n}),e.add({key:"measurements",value:this.measurements.map((function(e){return e.toYAML()}))}),e.add({key:"models",value:this.models.map((function(e){return e.toYAML()}))}),e.add({key:"vertices",value:this.vertices.map((function(e){return e.toYAML()}))}),e.add({key:"walls",value:this.walls.map((function(e){return e.toYAML()}))}),e}},{key:"calculateScale",value:function(){var e,t=0,n=0,a=Object(s.a)(this.measurements);try{for(a.s();!(e=a.n()).done;){var r=e.value;n++;var i=this.vertices[r.start_idx].x-this.vertices[r.end_idx].x,o=this.vertices[r.start_idx].y-this.vertices[r.end_idx].y,c=Math.sqrt(i*i+o*o);t+=r.distance/c}}catch(l){a.e(l)}finally{a.f()}this.scale=n>0?t/n:.05}},{key:"transformPoint",value:function(e,t){return[e*this.scale,t*this.scale]}},{key:"inverseTransformPoint",value:function(e,t){return[e/this.scale,t/this.scale]}}],[{key:"fromYAML",value:function(e,t){var a=new n;if(a.object_type_name="Level",a.uuid=Object(x.a)(),a.name=e,a.props.push(new w("name",(function(){return a.name}))),a.props.push(new w("elevation",(function(){return a.elevation}))),a.props.push(new w("scale",(function(){return a.scale}))),t.drawing&&t.drawing.filename){var r=new I;r.uuid=Object(x.a)(),r.filename=t.drawing.filename,r.isLegacyDefaultImage=!0,a.images.push(r)}for(var i in a.elevation=t.elevation,a.constraints=t.constraints.map((function(e){return T.fromYAML(e)})),a.doors=t.doors.map((function(e){return P.fromYAML(e)})),a.features=t.features.map((function(e){return _.fromYAML(e)})),a.floors=t.floors.map((function(e){return S.fromYAML(e)})),t.layers)a.images.push(I.fromLayerYAML(i,t.layers[i]));return a.lanes=t.lanes.map((function(e){return Y.fromYAML(e)})),a.models=t.models.map((function(e){return E.fromYAML(e)})),a.measurements=t.measurements.map((function(e){return C.fromYAML(e)})),a.vertices=t.vertices.map((function(e){return M.fromYAML(e)})),a.walls=t.walls.map((function(e){return A.fromYAML(e)})),a.calculateScale(),a}}]),n}(y),L=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="",e.url_base="",e.levels=[],e.reference_level_name="",e.yaml_doc=new h.a.Document,e}return Object(f.a)(n,[{key:"toYAMLString",value:function(){var e,t=new h.a.Document(new h.a.YAMLMap),n=new h.a.YAMLMap,a=Object(s.a)(this.levels);try{for(a.s();!(e=a.n()).done;){var r=e.value;n.add({key:r.name,value:r.toYAML()})}}catch(o){a.e(o)}finally{a.f()}t.add({key:"crowd_sim",value:this.yaml_doc.get("crowd_sim")}),t.add({key:"levels",value:n});var i=new h.a.YAMLMap;return i.flow=!0,t.add({key:"lifts",value:i}),t.add({key:"name",value:this.name}),t.toString({lineWidth:0,minContentWidth:2})}},{key:"computeBoundingBox",value:function(){var e,t=new p.Vector3(1/0,1/0,1/0),n=new p.Vector3(-1/0,-1/0,-1/0),a=Object(s.a)(this.levels);try{for(a.s();!(e=a.n()).done;){var r,i=e.value,o=Object(s.a)(i.vertices);try{for(o.s();!(r=o.n()).done;){var c=r.value;c.x<t.x&&(t.x=c.x),c.x>n.x&&(n.x=c.x),c.y<t.y&&(t.y=c.y),c.y>n.y&&(n.y=c.y)}}catch(l){o.e(l)}finally{o.f()}}}catch(l){a.e(l)}finally{a.f()}return new p.Box3(t,n)}},{key:"computeInitialCameraPose",value:function(){if(this.levels.length){var e=this.computeBoundingBox(),t=(e.min.x+e.max.x)/2,n=(e.min.y+e.max.y)/2,a=this.levels[0].transformPoint(t,n),r=Object(g.a)(a,2),i=r[0],o=r[1],c=new p.Vector3(i,o,0);return{position:new p.Vector3(c.x+10,c.y-10,c.z+10),target:c}}return{position:new p.Vector3(10,10,10),target:new p.Vector3(0,0,0)}}}],[{key:"fromYAML",value:function(e){var t=h.a.parse(e),a=new n;for(var r in a.uuid=Object(x.a)(),a.name=t.name,t.levels){var i=t.levels[r];a.levels.push(k.fromYAML(r,i))}return t.reference_level_name?a.reference_level_name=t.reference_level_name:a.levels.length>0&&(a.reference_level_name=a.levels[0].name),a.yaml_doc=h.a.parseDocument(e),a}}]),n}(y),A=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).start_idx=-1,e.end_idx=-1,e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLSeq;return e.add(this.start_idx),e.add(this.end_idx),e.add(this.paramsToYAML()),e.flow=!0,e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.object_type_name="Wall",t.uuid=Object(x.a)(),t.paramsFromYAML(e[2]),t.start_idx=e[0],t.end_idx=e[1],t}}]),n}(y),C=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).start_idx=-1,e.end_idx=-1,e.distance=1,e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLSeq;e.add(this.start_idx),e.add(this.end_idx);var t=this.paramsToYAML();return t.add({key:"distance",value:[3,this.distance]}),e.add(t),e.flow=!0,e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.object_type_name="Measurement",t.uuid=Object(x.a)(),t.start_idx=e[0],t.end_idx=e[1],t.distance=e[2].distance[1],t}}]),n}(y),Y=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).start_idx=-1,e.end_idx=-1,e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLSeq;return e.add(this.start_idx),e.add(this.end_idx),e.add(this.paramsToYAML()),e.flow=!0,e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.object_type_name="Lane",t.uuid=Object(x.a)(),t.paramsFromYAML(e[2]),t.start_idx=e[0],t.end_idx=e[1],t}}]),n}(y),P=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).start_idx=-1,e.end_idx=-1,e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLSeq;return e.add(this.start_idx),e.add(this.end_idx),e.add(this.paramsToYAML()),e.flow=!0,e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.object_type_name="Door",t.uuid=Object(x.a)(),t.paramsFromYAML(e[2]),t.start_idx=e[0],t.end_idx=e[1],t}}]),n}(y),S=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).vertex_indices=[],e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLMap;e.add({key:"parameters",value:this.paramsToYAML()});var t,n=new h.a.YAMLSeq,a=Object(s.a)(this.vertex_indices);try{for(a.s();!(t=a.n()).done;){var r=t.value;n.add(r)}}catch(i){a.e(i)}finally{a.f()}return n.flow=!0,e.add({key:"vertices",value:n}),e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.uuid=Object(x.a)(),t.paramsFromYAML(e.parameters),t.vertex_indices=e.vertices.map((function(e){return e})),t}}]),n}(y),I=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="",e.filename="",e.offset=new p.Vector3(0,0,0),e.yaw=0,e.scale=1,e.isLegacyDefaultImage=!1,e.color=[1,1,1,1],e.visible=!0,e.features=[],e.blob=new Blob([]),e}return Object(f.a)(n,[{key:"toLayerYAML",value:function(){var e=new h.a.YAMLMap,t=new h.a.YAMLSeq;t.add(this.color[0]),t.add(this.color[1]),t.add(this.color[2]),t.add(this.color[3]),t.flow=!0,e.add({key:"color",value:t}),e.add({key:"features",value:this.features.map((function(e){return e.toYAML()}))}),e.add({key:"filename",value:this.filename});var n=new h.a.YAMLMap;return n.add({key:"scale",value:this.scale}),n.add({key:"translation_x",value:this.offset.x}),n.add({key:"translation_y",value:this.offset.y}),n.add({key:"yaw",value:this.yaw}),e.add({key:"transform",value:n}),e.add({key:"visible",value:this.visible}),e}},{key:"loadBlob",value:function(e){this.blob=e,console.log("image ".concat(this.filename," retrieved ").concat(this.blob.size," bytes"))}}],[{key:"fromLayerYAML",value:function(e,t){var a=new n;return a.object_type_name="Image",a.uuid=Object(x.a)(),a.name=e,a.filename=t.filename,a.color=t.color,a.offset.x=t.transform.translation_x,a.offset.y=t.transform.translation_y,a.scale=t.transform.scale,a.yaw=t.transform.yaw,a.isLegacyDefaultImage=!1,a.visible=t.visible,a.features=t.features.map((function(e){return _.fromYAML(e)})),a}}]),n}(y),T=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).ids=[],e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLMap;return e.add({key:"ids",value:this.ids}),e.flow=!0,e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.uuid=Object(x.a)(),t.ids=[e.ids[0],e.ids[1]],t}}]),n}(y),E=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).model_name="",e.instance_name="",e.is_static=!0,e.x=0,e.y=0,e.z=0,e.yaw=0,e}return Object(f.a)(n,[{key:"toYAML",value:function(){var e=new h.a.YAMLMap;return e.add({key:"model_name",value:this.model_name}),e.add({key:"name",value:this.instance_name}),e.add({key:"static",value:this.is_static}),e.add({key:"x",value:this.x}),e.add({key:"y",value:-this.y}),e.add({key:"yaw",value:this.yaw}),e.add({key:"z",value:this.z}),e.flow=!0,e}}],[{key:"fromYAML",value:function(e){var t=new n;return t.object_type_name="Model",t.uuid=Object(x.a)(),t.model_name=e.model_name,t.instance_name=e.name,t.is_static=e.static,t.x=e.x,t.y=-e.y,t.yaw=e.yaw,t.z=e.z,t}}]),n}(y);!function(e){e[e.SELECT=0]="SELECT",e[e.MOVE=1]="MOVE"}(a||(a={}));var D=Object(j.a)((function(e){return{building:new L,selection:null,editorMode:"2d",enableMotionControls:!0,activeTool:a.SELECT,propertyRepaintCount:0,repaintCount:0,cameraInitialPose:{position:new p.Vector3(0,0,5),target:new p.Vector3(0,0,0)},set:function(t){return e(Object(b.a)(t))}}}));function N(e,t){e((function(e){e.selection=t}))}function B(e){e((function(e){e.selection=null}))}function V(e,t){e((function(e){e.activeTool=t}))}function R(e){e((function(e){e.propertyRepaintCount+=1}))}function z(e,t,n,a,r){e((function(e){e.building.levels.map((function(e){return e.uuid===t&&e.vertices.map((function(e){return e.uuid===n&&(e.x=a,e.y=r),e})),e})),e.repaintCount=e.repaintCount+1}))}function F(e,t,n,a,r){e((function(e){e.building.levels.map((function(e){return e.uuid===t&&e.models.map((function(e){return e.uuid===n&&(e.x=a,e.y=r),e})),e})),e.repaintCount=e.repaintCount+1}))}function G(e,t,n,a,r){e((function(e){e.building.levels.map((function(e){return e===t&&e.features.map((function(e){return e.uuid===n&&(e.x=a,e.y=r),e})),e})),e.repaintCount=e.repaintCount+1}))}var q=n(199),H=n(233),U=n(107),W=n.n(U),J=n(108),K=n.n(J),Q=n(4);function X(e){var t=D((function(e){return e.set}));return Object(Q.jsx)(H.a,{nodeId:e.feature.uuid,label:"".concat(e.feature.x,", ").concat(e.feature.y),onClick:function(n){N(t,e.feature)}},e.feature.uuid)}function Z(e){var t=D((function(e){return e.set}));return Object(Q.jsx)(H.a,{nodeId:e.model.uuid,label:"".concat(e.model.instance_name),onClick:function(n){N(t,e.model)}},e.model.uuid)}function $(e){var t=D((function(e){return e.set}));return Object(Q.jsx)(H.a,{nodeId:e.constraint.uuid,label:"".concat(e.constraint.ids[0].substring(1,9)," - ").concat(e.constraint.ids[1].substring(1,9)),onClick:function(n){N(t,e.constraint)},children:e.constraint.params.map((function(e){return Object(Q.jsx)(te,{param:e})}))},e.constraint.uuid)}function ee(e){var t=D((function(e){return e.set})),n="(".concat(e.door.start_idx," => ").concat(e.door.end_idx,")");return Object(Q.jsx)(H.a,{nodeId:e.door.uuid,onClick:function(n){N(t,e.door)},label:n},e.door.uuid)}function te(e){return Object(Q.jsx)(H.a,{nodeId:e.param.uuid,label:"".concat(e.param.name," = ").concat(e.param.value)},e.param.uuid)}function ne(e){var t=D((function(e){return e.set}));return Object(Q.jsxs)(H.a,{nodeId:e.image.uuid,label:e.image.filename,onClick:function(n){N(t,e.image)},children:[e.image.params.map((function(e){return Object(Q.jsx)(te,{param:e})})),Object(Q.jsx)(H.a,{nodeId:"".concat(e.image.uuid,"_features"),label:"features",children:e.image.features.map((function(e){return Object(Q.jsx)(X,{feature:e})}))},"".concat(e.image.uuid,"_features"))]},e.image.uuid)}function ae(e){var t=D((function(e){return e.set})),n="floor ("+e.floor.vertex_indices.map((function(e){return e.toString()})).join(", ")+")";return Object(Q.jsx)(H.a,{nodeId:e.floor.uuid,label:n,onClick:function(n){N(t,e.floor)},children:e.floor.params.map((function(e){return Object(Q.jsx)(te,{param:e})}))},e.floor.uuid)}function re(e){var t=D((function(e){return e.set})),n="(".concat(e.wall.start_idx," => ").concat(e.wall.end_idx,")");return Object(Q.jsx)(H.a,{nodeId:e.wall.uuid,onClick:function(n){N(t,e.wall)},label:n},e.wall.uuid)}function ie(e){var t=D((function(e){return e.set})),n="(".concat(e.measurement.start_idx,"-").concat(e.measurement.end_idx,") = ").concat(e.measurement.distance);return Object(Q.jsx)(H.a,{nodeId:e.measurement.uuid,onClick:function(n){N(t,e.measurement)},label:n},e.measurement.uuid)}function oe(e){var t=D((function(e){return e.set})),n="(".concat(e.lane.start_idx," => ").concat(e.lane.end_idx,")");return Object(Q.jsx)(H.a,{nodeId:e.lane.uuid,label:n,onClick:function(n){N(t,e.lane)}},e.lane.uuid)}function ce(e){var t=D((function(e){return e.set})),n="("+e.vertex.x+", "+e.vertex.y+")";return e.vertex.name&&(n=e.vertex.name+": "+n),Object(Q.jsx)(H.a,{nodeId:e.vertex.uuid,onClick:function(n){N(t,e.vertex)},label:n,children:e.vertex.params.map((function(e){return Object(Q.jsx)(te,{param:e})}))},e.vertex.uuid)}function le(e){var t=D((function(e){return e.set}));return Object(Q.jsxs)(H.a,{nodeId:e.level.uuid,label:e.level.name,onClick:function(n){N(t,e.level)},children:[Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_constraints",label:"constraints",children:e.level.constraints.map((function(e){return Object(Q.jsx)($,{constraint:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_doors",label:"doors",children:e.level.doors.map((function(e){return Object(Q.jsx)(ee,{door:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_features",label:"features",children:e.level.features.map((function(e){return Object(Q.jsx)(X,{feature:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_floors",label:"floors",children:e.level.floors.map((function(e){return Object(Q.jsx)(ae,{floor:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_images",label:"images",children:e.level.images.map((function(e){return Object(Q.jsx)(ne,{image:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_lanes",label:"lanes",children:e.level.lanes.map((function(e){return Object(Q.jsx)(oe,{lane:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_measurements",label:"measurements",children:e.level.measurements.map((function(e){return Object(Q.jsx)(ie,{measurement:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_models",label:"models",children:e.level.models.map((function(e){return Object(Q.jsx)(Z,{model:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_vertices",label:"vertices",children:e.level.vertices.map((function(e){return Object(Q.jsx)(ce,{vertex:e})}))}),Object(Q.jsx)(H.a,{nodeId:e.level.uuid+"_walls",label:"walls",children:e.level.walls.map((function(e){return Object(Q.jsx)(re,{wall:e})}))})]},e.level.uuid)}function ue(){var e=D((function(e){return e.building}));return""===e.name?Object(Q.jsxs)("div",{style:{margin:"1em"},children:[Object(Q.jsx)("p",{children:"No map loaded."}),Object(Q.jsx)("p",{children:"To load a map, click the menu icon in the upper-left."})]}):Object(Q.jsxs)(q.a,{defaultCollapseIcon:Object(Q.jsx)(W.a,{}),defaultExpandIcon:Object(Q.jsx)(K.a,{}),children:[Object(Q.jsx)(H.a,{nodeId:e.uuid+"_name",label:"name: "+e.name}),Object(Q.jsx)(H.a,{nodeId:e.uuid+"_ref",label:"reference level: "+e.reference_level_name}),Object(Q.jsx)(H.a,{nodeId:e.uuid+"_levels",label:"levels",children:e.levels.map((function(e){return Object(Q.jsx)(le,{level:e})}))})]})}var se=n(30),de=n(229),fe=n(200),ve=n(201);function me(e){var t=D((function(e){return e.selection})),n=D((function(e){return e.set})),a=e.vertex_start,r=e.vertex_end,o=e.level.transformPoint((a.x+r.x)/2,(a.y+r.y)/2),c=Object(g.a)(o,2),l=c[0],u=c[1],s=r.x-a.x,d=r.y-a.y,f=Math.sqrt(s*s+d*d)*e.level.scale,v=Math.atan2(d,s),m=i.a.useMemo((function(){var n=new p.Color(.1,.4,.4);return t&&t.uuid===e.door.uuid&&n.setRGB(1,.4,.1),n}),[t,e.door.uuid]);return Object(Q.jsxs)("mesh",{position:[l,u,1+e.elevation],rotation:new p.Euler(0,0,v),scale:1,onClick:function(t){t.stopPropagation(),N(n,e.door)},children:[Object(Q.jsx)("boxGeometry",{args:[f,.5,2]}),Object(Q.jsx)("meshStandardMaterial",{color:m})]},e.door.uuid)}var je=n(228);function be(e){var t=D((function(e){return e.selection})),n=D((function(e){return e.set})),r=D((function(e){return e.editorMode})),o=D((function(e){return e.activeTool===a.MOVE})),c=i.a.useState(!1),l=Object(g.a)(c,2),u=l[0],s=l[1],d=e.level.transformPoint(e.feature.x,e.feature.y),f=Object(g.a)(d,2),v=f[0],m=f[1],j="rgb(200, 200, 0)";return t&&t.uuid===e.feature.uuid&&(j="rgb(255, 100, 10)"),Object(Q.jsxs)("group",{children:[Object(Q.jsxs)("mesh",{position:[v,m,.25+e.elevation],scale:1,rotation:new p.Euler(Math.PI/2,0,0),onClick:function(e){e.stopPropagation()},onPointerDown:function(t){N(n,e.feature),o&&(t.stopPropagation(),s(!0),t.target&&t.target.setPointerCapture(t.pointerId))},onPointerUp:function(e){e.stopPropagation(),s(!1),e.target&&e.target.releasePointerCapture(e.pointerId),R(n)},onPointerMove:function(t){if(u)if(t.stopPropagation(),"2d"===r){var a=e.level.inverseTransformPoint(t.unprojectedPoint.x,t.unprojectedPoint.y),i=Object(g.a)(a,2),o=i[0],c=i[1];G(n,e.level,e.feature.uuid,o,c)}else{var l=new p.Vector3;t.ray.intersectPlane(new p.Plane(new p.Vector3(0,0,1),e.elevation),l);var s=e.level.inverseTransformPoint(l.x,l.y),d=Object(g.a)(s,2),f=d[0],v=d[1];G(n,e.level,e.feature.uuid,f,v)}},children:[Object(Q.jsx)("cylinderGeometry",{args:[.05,.15,.4,16]}),Object(Q.jsx)("meshStandardMaterial",{color:j})]},e.feature.uuid),Object(Q.jsx)(je.a,{color:"blue",position:[v,m,.36+e.elevation],children:e.feature.name})]})}function pe(e){var t=D((function(e){return e.selection})),n=D((function(e){return e.set})),a=i.a.useMemo((function(){var t,n=new p.Shape,a=!1,r=Object(s.a)(e.vertices);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=e.level.transformPoint(i.x,i.y),c=Object(g.a)(o,2),l=c[0],u=c[1];a?n.lineTo(l,u):(n.moveTo(l,u),a=!0)}}catch(j){r.e(j)}finally{r.f()}var d=e.level.transformPoint(e.vertices[0].x,e.vertices[0].y),f=Object(g.a)(d,2),v=f[0],m=f[1];return n.lineTo(v,m),n}),[e.vertices,e.level]),r=i.a.useMemo((function(){var n=new p.Color(1,1,1);return t&&t.uuid===e.floor.uuid&&n.setRGB(1,.4,.1),n}),[t,e.floor.uuid]);return Object(Q.jsxs)("mesh",{onClick:function(t){t.stopPropagation(),console.log("floor onClick"),N(n,e.floor)},children:[Object(Q.jsx)("extrudeGeometry",{args:[a,{depth:.1,bevelEnabled:!1}]}),Object(Q.jsx)("meshStandardMaterial",{color:r})]},e.floor.uuid)}function xe(e){var t=D((function(e){return e.selection})),n=D((function(e){return e.set})),a=e.vertex_start,r=e.vertex_end,o=e.level.transformPoint((a.x+r.x)/2,(a.y+r.y)/2),c=Object(g.a)(o,2),l=c[0],u=c[1],s=r.x-a.x,d=r.y-a.y,f=Math.sqrt(s*s+d*d)*e.level.scale,v=Math.atan2(d,s),m=i.a.useMemo((function(){var n=new p.Color(.4,.05,.05);return t&&t.uuid===e.lane.uuid&&n.setRGB(.8,.3,.01),n}),[t,e.lane.uuid]);return Object(Q.jsxs)("mesh",{position:[l,u,.2+e.elevation],rotation:new p.Euler(0,0,v),scale:1,onClick:function(t){t.stopPropagation(),N(n,e.lane)},children:[Object(Q.jsx)("boxGeometry",{args:[f,1,.1]}),Object(Q.jsx)("meshStandardMaterial",{color:m})]},e.lane.uuid)}var he=n(119);function Oe(e){var t=D((function(e){return e.building.url_base})),n=Object(se.c)(he.a,[t+e.image.filename]),a=Object(g.a)(n,1)[0],r=128,i=128,o=50,c=50;a&&(a.magFilter=p.NearestFilter,a.minFilter=p.NearestFilter,r=a.image.width,i=a.image.height,o=r*e.level.scale,c=i*e.level.scale);var l=e.image.offset.x,u=e.image.offset.y,s=e.image.yaw;return Object(Q.jsxs)("mesh",{position:[l+o/2,u-c/2,e.elevation+.1],scale:1,rotation:new p.Euler(0,s,0),children:[Object(Q.jsx)("boxGeometry",{args:[o,c,.1,8]}),Object(Q.jsx)("meshStandardMaterial",{map:a,color:[1,1,1]})]},e.image.uuid)}function ye(e){var t=D((function(e){return e.selection})),n=D((function(e){return e.set})),a=e.vertex_start,r=e.vertex_end,o=e.level.transformPoint((a.x+r.x)/2,(a.y+r.y)/2),c=Object(g.a)(o,2),l=c[0],u=c[1],s=r.x-a.x,d=r.y-a.y,f=Math.sqrt(s*s+d*d)*e.level.scale,v=Math.atan2(d,s),m=i.a.useMemo((function(){var n=new p.Color(.6,.1,.6);return t&&t.uuid===e.measurement.uuid&&n.setRGB(.8,.3,.01),n}),[t,e.measurement.uuid]);return Object(Q.jsxs)("mesh",{position:[l,u,.2+e.elevation],rotation:new p.Euler(0,0,v),scale:1,onClick:function(t){t.stopPropagation(),N(n,e.measurement)},children:[Object(Q.jsx)("boxGeometry",{args:[f,.5,.1]}),Object(Q.jsx)("meshStandardMaterial",{color:m})]},e.measurement.uuid)}function ge(e){var t=D((function(e){return e.selection})),n=D((function(e){return e.set})),r=D((function(e){return e.editorMode})),o=D((function(e){return e.activeTool===a.MOVE})),c=i.a.useState(!1),l=Object(g.a)(c,2),u=l[0],s=l[1],d=e.level.transformPoint(e.model.x,e.model.y),f=Object(g.a)(d,2),v=f[0],m=f[1],j="rgb(128, 128, 128)";return t&&t.uuid===e.model.uuid&&(j="rgb(255, 100, 10)"),Object(Q.jsxs)("mesh",{position:[v,m,.25+e.elevation],scale:1,rotation:new p.Euler(Math.PI/2,e.model.yaw,0),onClick:function(t){t.stopPropagation(),N(n,e.model)},onPointerDown:function(e){o&&(e.stopPropagation(),s(!0),e.target&&e.target.setPointerCapture(e.pointerId))},onPointerUp:function(e){e.stopPropagation(),s(!1),e.target&&e.target.releasePointerCapture(e.pointerId)},onPointerMove:function(t){if(u)if(t.stopPropagation(),"2d"===r){var a=e.level.inverseTransformPoint(t.unprojectedPoint.x,t.unprojectedPoint.y),i=Object(g.a)(a,2),o=i[0],c=i[1];F(n,e.level_uuid,e.model.uuid,o,c)}else{var l=new p.Vector3;t.ray.intersectPlane(new p.Plane(new p.Vector3(0,0,1),e.elevation),l);var s=e.level.inverseTransformPoint(l.x,l.y),d=Object(g.a)(s,2),f=d[0],v=d[1];F(n,e.level_uuid,e.model.uuid,f,v)}},children:[Object(Q.jsx)("boxGeometry",{args:[.4,.4,.4,8]}),Object(Q.jsx)("meshStandardMaterial",{color:j})]},e.model.uuid)}function we(e){var t=D((function(e){return e.selection})),n=D((function(e){return e.set})),r=D((function(e){return e.editorMode})),o=D((function(e){return e.activeTool===a.MOVE})),c=i.a.useState(!1),l=Object(g.a)(c,2),u=l[0],s=l[1],d=e.level.transformPoint(e.vertex.x,e.vertex.y),f=Object(g.a)(d,2),v=f[0],m=f[1],j="rgb(0, 128, 0)";return t&&t.uuid===e.vertex.uuid&&(j="rgb(255, 100, 10)"),Object(Q.jsxs)("group",{children:[Object(Q.jsxs)("mesh",{position:[v,m,.25+e.elevation],scale:1,rotation:new p.Euler(Math.PI/2,0,0),onClick:function(e){e.stopPropagation()},onPointerDown:function(t){N(n,e.vertex),o&&(t.stopPropagation(),s(!0),t.target&&t.target.setPointerCapture(t.pointerId))},onPointerUp:function(e){e.stopPropagation(),s(!1),e.target&&e.target.releasePointerCapture(e.pointerId),R(n)},onPointerMove:function(t){if(u)if(t.stopPropagation(),"2d"===r){var a=e.level.inverseTransformPoint(t.unprojectedPoint.x,t.unprojectedPoint.y),i=Object(g.a)(a,2),o=i[0],c=i[1];z(n,e.level_uuid,e.vertex.uuid,o,c)}else{var l=new p.Vector3;t.ray.intersectPlane(new p.Plane(new p.Vector3(0,0,1),e.elevation),l);var s=e.level.inverseTransformPoint(l.x,l.y),d=Object(g.a)(s,2),f=d[0],v=d[1];z(n,e.level_uuid,e.vertex.uuid,f,v)}},children:[Object(Q.jsx)("cylinderGeometry",{args:[.1,.1,.2,16]}),Object(Q.jsx)("meshStandardMaterial",{color:j})]},e.vertex.uuid),Object(Q.jsx)(je.a,{color:"blue",position:[v,m,.36+e.elevation],children:e.vertex.name})]})}function Me(e){var t=D((function(e){return e.selection})),n=D((function(e){return e.set})),a=e.vertex_start,r=e.vertex_end,o=e.level.transformPoint((a.x+r.x)/2,(a.y+r.y)/2),c=Object(g.a)(o,2),l=c[0],u=c[1],s=r.x-a.x,d=r.y-a.y,f=Math.sqrt(s*s+d*d)*e.level.scale,v=Math.atan2(d,s),m=i.a.useMemo((function(){var n=new p.Color(.1,.1,.7);return t&&t.uuid===e.wall.uuid&&n.setRGB(1,.4,.1),n}),[t,e.wall.uuid]);return Object(Q.jsxs)("mesh",{position:[l,u,1+e.elevation],rotation:new p.Euler(0,0,v),scale:1,onClick:function(t){t.stopPropagation(),N(n,e.wall)},children:[Object(Q.jsx)("boxGeometry",{args:[f,.1,2]}),Object(Q.jsx)("meshStandardMaterial",{color:m})]},e.wall.uuid)}function _e(e){var t=e.level.elevation/2;return D((function(e){return e.selection})),Object(Q.jsxs)("group",{children:[e.level.models.map((function(n){return Object(Q.jsx)(ge,{model:n,level:e.level,level_uuid:e.level.uuid,elevation:t},n.uuid)})),e.level.vertices.map((function(n){return Object(Q.jsx)(we,{vertex:n,level:e.level,level_uuid:e.level.uuid,elevation:t},n.uuid)})),e.level.features.map((function(n){return Object(Q.jsx)(be,{feature:n,level:e.level,elevation:t},n.uuid)})),e.level.walls.map((function(n){return Object(Q.jsx)(Me,{wall:n,level:e.level,vertex_start:e.level.vertices[n.start_idx],vertex_end:e.level.vertices[n.end_idx],elevation:t},n.uuid)})),e.level.doors.map((function(n){return Object(Q.jsx)(me,{door:n,level:e.level,vertex_start:e.level.vertices[n.start_idx],vertex_end:e.level.vertices[n.end_idx],elevation:t},n.uuid)})),e.level.floors.map((function(n){return Object(Q.jsx)(pe,{floor:n,level:e.level,vertices:n.vertex_indices.map((function(t){return e.level.vertices[t]})),elevation:t},n.uuid)})),e.level.lanes.map((function(n){return Object(Q.jsx)(xe,{lane:n,level:e.level,vertex_start:e.level.vertices[n.start_idx],vertex_end:e.level.vertices[n.end_idx],elevation:t},n.uuid)})),e.level.images.filter((function(e){return e.isLegacyDefaultImage})).map((function(n){return Object(Q.jsx)(Oe,{image:n,level:e.level,elevation:t},n.uuid)})),e.level.measurements.map((function(n){return Object(Q.jsx)(ye,{measurement:n,level:e.level,vertex_start:e.level.vertices[n.start_idx],vertex_end:e.level.vertices[n.end_idx],elevation:t},n.uuid)}))]})}function ke(e){var t=D((function(e){return e.building}));return D((function(e){return e.selection})),D((function(e){return e.repaintCount})),Object(Q.jsx)("group",{children:t.levels.map((function(e){return Object(Q.jsx)(_e,{level:e},e.uuid)}))})}function Le(e){var t=D((function(e){return e.set})),n=D((function(e){return e.editorMode})),a=D((function(e){return e.cameraInitialPose})),i=function(){p.Object3D.DefaultUp=new p.Vector3(0,0,1);var e=Object(r.useRef)(null),t=Object(r.useRef)(null),i=D((function(e){return e.enableMotionControls}));return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(fe.a,{ref:e,position:a.position,fov:60,makeDefault:"3d"===n}),Object(Q.jsx)(ve.a,{ref:t,position:[a.target.x,a.target.y,a.target.z+5],zoom:20,makeDefault:"2d"===n}),e&&t&&Object(Q.jsx)(de.a,{enableDamping:!1,screenSpacePanning:"3d"!==n,target:a.target,camera:"3d"===n?e.current:t.current,maxPolarAngle:"3d"===n?1/0:0,minAzimuthAngle:"3d"===n?-1/0:0,maxAzimuthAngle:"3d"===n?1/0:0,mouseButtons:{LEFT:-1,MIDDLE:p.MOUSE.PAN,RIGHT:p.MOUSE.ROTATE},touches:{ONE:p.TOUCH.PAN,TWO:p.TOUCH.ROTATE},enabled:i})]})};return console.log("EditorScene()"),Object(Q.jsxs)(se.a,{frameloop:"demand",onPointerMissed:function(){B(t)},children:[Object(Q.jsx)(i,{}),Object(Q.jsx)("axesHelper",{}),Object(Q.jsx)("ambientLight",{}),Object(Q.jsx)("pointLight",{position:[10,10,10]}),Object(Q.jsx)(r.Suspense,{fallback:null,children:Object(Q.jsx)(ke,{})})]})}var Ae=n(203),Ce=n(204),Ye=n(206),Pe=n(205),Se=n(207),Ie=Object(l.a)((function(e){return{noSelectionDiv:{},table:{padding:"0px",margin:"0px"},tableHead:{},tableHeadRow:{borderBottomStyle:"solid",borderBottom:"1px",borderBottomColor:e.palette.primary.main},tableHeadCell:{fontWeight:"bold",padding:"0px",paddingLeft:"5px"},tableCell:{padding:"0px",paddingLeft:"5px"}}}));function Te(){var e=Ie(),t=D((function(e){return e.selection}));return D((function(e){return e.propertyRepaintCount})),t?Object(Q.jsxs)(Ae.a,{className:e.table,children:[Object(Q.jsxs)(Ce.a,{children:[Object(Q.jsx)(Pe.a,{className:e.tableHeadCell,children:t.object_type_name}),Object(Q.jsx)(Pe.a,{className:e.tableHeadCell})]}),Object(Q.jsxs)(Ye.a,{children:[t.props.map((function(t){return Object(Q.jsxs)(Se.a,{children:[Object(Q.jsx)(Pe.a,{className:e.tableCell,children:t.name}),Object(Q.jsx)(Pe.a,{className:e.tableCell,children:t.get_value()})]})})),t.params.map((function(t){return Object(Q.jsxs)(Se.a,{children:[Object(Q.jsx)(Pe.a,{className:e.tableCell,children:t.name}),Object(Q.jsx)(Pe.a,{className:e.tableCell,children:t.value.toString()})]})}))]})]}):Object(Q.jsx)("div",{className:e.noSelectionDiv})}var Ee=n(13),De=n.n(Ee),Ne=n(39),Be=n(217),Ve=n(222),Re=n(218),ze=n(235),Fe=n(219),Ge=n(223),qe=n(234),He=n(113),Ue=n.n(He),We=n(230),Je=n(221),Ke=n(210),Qe=n(211),Xe=n(231),Ze=n(225),$e=n(72),et=n(16),tt=n(33),nt=n(111),at=n(232),rt=n(213),it=n(214),ot=n(216),ct=n(208),lt=n(209),ut=n(148),st=n(112),dt=n.n(st),ft=n(215);function vt(e,t){var n=L.fromYAML(e);n.url_base=t;var a=n.computeInitialCameraPose();return D.setState({building:n,selection:null,cameraInitialPose:a}),n}function mt(e,t){return jt.apply(this,arguments)}function jt(){return(jt=Object(Ne.a)(De.a.mark((function e(t,n){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t+n).then((function(e){return e.text()})).then((function(e){return vt(e,t)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(e){return pt.apply(this,arguments)}function pt(){return(pt=Object(Ne.a)(De.a.mark((function e(t){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt("/traffic-editor-js"+"/demos/".concat(t,"/"),"".concat(t,".building.yaml"));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xt(e){return ht.apply(this,arguments)}function ht(){return(ht=Object(Ne.a)(De.a.mark((function e(t){var n,a,r,i;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object.getPrototypeOf(h.a.YAMLMap).maxFlowStringSingleLineLength=1e4,n=D.getState(),a=n.building,r=a.toYAMLString(),i=new Blob([r]).size,e.next=6,fetch(t,{method:"POST",headers:{"content-type":"application/x-yaml","content-length":i.toString()},body:r});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ot=Object(l.a)((function(e){return{directoryButton:{fontSize:e.typography.h5.fontSize},filename:{fontSize:e.typography.h5.fontSize,textDecoration:"underline"},dialog:{backgroundColor:e.palette.background.paper}}}));function yt(e){var t=Ot(e),n=i.a.useState([]),a=Object(g.a)(n,2),r=a[0],o=a[1],c=i.a.useState(),l=Object(g.a)(c,2),u=l[0],s=l[1],d=function(){var e=Object(Ne.a)(De.a.mark((function e(){var t,n,a,r,i,c,l,u;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o([]),e.next=3,window.showDirectoryPicker();case 3:return t=e.sent,e.next=6,s(t);case 6:n=!0,a=!1,e.prev=8,i=function(){var e=u;e.name.endsWith(".building.yaml")&&o((function(t){return[].concat(Object(tt.a)(t),[e.name])}))},c=Object(nt.a)(t.values());case 11:return e.next=13,c.next();case 13:return l=e.sent,n=l.done,e.next=17,l.value;case 17:if(u=e.sent,n){e.next=23;break}i();case 20:n=!0,e.next=11;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(8),a=!0,r=e.t0;case 29:if(e.prev=29,e.prev=30,n||null==c.return){e.next=34;break}return e.next=34,c.return();case 34:if(e.prev=34,!a){e.next=37;break}throw r;case 37:return e.finish(34);case 38:return e.finish(29);case 39:case"end":return e.stop()}}),e,null,[[8,25,29,39],[30,,34,38]])})));return function(){return e.apply(this,arguments)}}(),f=function(){var t=Object(Ne.a)(De.a.mark((function t(n){var a,r;return De.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u){t.next=11;break}return t.next=3,u.getFileHandle(n);case 3:return a=t.sent,t.next=6,a.getFile();case 6:return r=t.sent,t.next=9,r.text();case 9:vt(t.sent,"");case 11:e.onOpen();case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(Q.jsxs)(at.a,{open:e.open,onClose:e.onCancel,children:[Object(Q.jsx)(rt.a,{children:"Open Building Map"}),Object(Q.jsxs)(it.a,{className:t.dialog,children:[Object(Q.jsx)(ft.a,{variant:"contained",color:"primary",onClick:d,children:"Select Directory..."}),function(){if(r.length>0)return Object(Q.jsx)("div",{children:Object(Q.jsx)(ct.a,{subheader:Object(Q.jsx)(lt.a,{component:"div",children:"Available Files"}),children:r.map((function(e){return Object(Q.jsxs)(ut.a,{button:!0,children:[Object(Q.jsx)(Ke.a,{children:Object(Q.jsx)(dt.a,{})}),Object(Q.jsx)(Qe.a,{primary:e,onClick:function(t){f(e)}})]},e)}))})})}()]}),Object(Q.jsx)(ot.a,{children:Object(Q.jsx)(ft.a,{onClick:e.onCancel,color:"primary",children:"Cancel"})})]})}var gt=n(117),wt=n.n(gt),Mt=n(116),_t=n.n(Mt),kt=n(93),Lt=n.n(kt),At=n(114),Ct=n.n(At),Yt=n(118),Pt=n.n(Yt),St=Object(et.a)((function(e){return{root:{backgroundColor:e.palette.primary.light,padding:e.spacing(.5),marginRight:5},grouped:{color:e.palette.primary.contrastText,"&.Mui-selected:hover, &:hover":{background:e.palette.primary.dark},"&.Mui-selected":{background:e.palette.primary.dark,color:e.palette.primary.contrastText}}}}))(qe.a),It=Object(l.a)((function(e){return{flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20},appTitle:{marginRight:20},filler:{flex:1}}}));function Tt(e){var t=It(e),n=i.a.useState(null),o=Object(g.a)(n,2),c=o[0],l=o[1],u=i.a.useState(!1),s=Object(g.a)(u,2),d=s[0],f=s[1],v=i.a.useState(!1),m=Object(g.a)(v,2),j=m[0],b=m[1],p=i.a.useState(""),x=Object(g.a)(p,2),h=x[0],O=x[1],y=i.a.useState(""),w=Object(g.a)(y,2),M=w[0],_=w[1],k=D((function(e){return e.set})),L=D((function(e){return e.editorMode})),A=D((function(e){return e.activeTool})),C=Object(r.useCallback)(Object(Ne.a)(De.a.mark((function e(){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("local_file"!==M){e.next=5;break}O("Cannot save. Local file save not yet implemented."),b(!0),e.next=18;break;case 5:if("local_rest"!==M){e.next=17;break}return e.prev=6,e.next=9,xt("http://localhost:8000/map_file");case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(6),O("Error while saving to local REST server"),b(!0);case 15:e.next=18;break;case 17:"demo"===M?(O("Cannot save. Demo maps are read-only."),b(!0)):(O("Cannot save. No map loaded."),b(!0));case 18:case"end":return e.stop()}}),e,null,[[6,11]])}))),[M]),Y=function(){b(!1)};return i.a.useEffect((function(){var e=function(e){var t=e.key.toLowerCase();if("m"===t)V(k,a.MOVE),B(k);else if("escape"===t)V(k,a.SELECT),B(k);else if("s"===t&&e.ctrlKey)return e.preventDefault(),C(),!1};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[k,C]),Object(Q.jsxs)(Be.a,{position:"fixed",children:[Object(Q.jsxs)(Re.a,{children:[Object(Q.jsx)(Fe.a,{className:t.menuButton,color:"inherit","aria-label":"Menu",onClick:function(e){l(e.currentTarget)},children:Object(Q.jsx)(Ue.a,{})}),Object(Q.jsxs)(We.a,{keepMounted:!0,anchorEl:c,open:Boolean(c),onClose:function(){return l(null)},getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},transitionDuration:0,children:[Object(Q.jsxs)(Je.a,{onClick:Object(Ne.a)(De.a.mark((function e(){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,mt("http://localhost:8000/","map_file");case 3:_("local_rest"),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),O("could not open file from localhost:8000"),b(!0);case 10:l(null);case 11:case"end":return e.stop()}}),e,null,[[0,6]])}))),children:[Object(Q.jsx)(Ke.a,{children:Object(Q.jsx)(Lt.a,{})}),Object(Q.jsx)(Qe.a,{children:"Open map from localhost:8000"})]}),Object(Q.jsxs)(Je.a,{onClick:Object(Ne.a)(De.a.mark((function e(){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bt("office");case 2:_("demo"),l(null);case 4:case"end":return e.stop()}}),e)}))),children:[Object(Q.jsx)(Ke.a,{children:Object(Q.jsx)(Lt.a,{})}),Object(Q.jsx)(Qe.a,{children:"Open demo map"})]}),Object(Q.jsxs)(Je.a,{onClick:function(){f(!0),_("local_file"),l(null)},children:[Object(Q.jsx)(Ke.a,{children:Object(Q.jsx)(Lt.a,{})}),Object(Q.jsx)(Qe.a,{children:"Open map from local file..."})]}),Object(Q.jsx)(Ve.a,{}),Object(Q.jsxs)(Je.a,{onClick:function(){C(),l(null)},children:[Object(Q.jsx)(Ke.a,{children:Object(Q.jsx)(Ct.a,{})}),Object(Q.jsx)(Qe.a,{children:"Save"})]})]}),Object(Q.jsx)($e.a,{variant:"h6",color:"inherit",className:t.appTitle,children:"Traffic Editor"}),Object(Q.jsx)("div",{className:t.filler}),Object(Q.jsxs)(St,{value:A,size:"small",exclusive:!0,onChange:function(e,t){null!==t&&(V(k,t),B(k))},"aria-label":"tool",children:[Object(Q.jsx)(Ge.a,{value:a.SELECT,children:Object(Q.jsx)(ze.a,{title:"Select tool [Escape]",children:Object(Q.jsx)(_t.a,{})})}),Object(Q.jsx)(Ge.a,{value:a.MOVE,children:Object(Q.jsx)(ze.a,{title:"Move tool [m]",children:Object(Q.jsx)(wt.a,{})})})]}),Object(Q.jsxs)(St,{value:L,size:"small",exclusive:!0,onChange:function(e,t){null!==t&&(!function(e,t){e((function(e){e.editorMode=t}))}(k,t),B(k))},"aria-label":"editor mode",children:[Object(Q.jsx)(Ge.a,{value:"3d",children:"3D"}),Object(Q.jsx)(Ge.a,{value:"2d",children:"2D"})]})]}),Object(Q.jsx)(yt,{open:d,onOpen:function(){return f(!1)},onCancel:function(){return f(!1)}}),Object(Q.jsx)(Xe.a,{anchorOrigin:{vertical:"top",horizontal:"left"},open:j,onClose:Y,autoHideDuration:2e3,transitionDuration:0,TransitionProps:{appear:!1},action:Object(Q.jsx)(i.a.Fragment,{children:Object(Q.jsx)(Fe.a,{onClick:Y,children:Object(Q.jsx)(Pt.a,{})})}),children:Object(Q.jsx)(Ze.a,{elevation:6,variant:"filled",severity:"error",onClose:Y,children:h})})]})}var Et=Object(l.a)((function(e){return{root:{flexGrow:1,minHeight:"100vh"},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20},toolbarMargin:e.mixins.toolbar,workingArea:{backgroundColor:"black",height:"calc(100vh - 64px)"},gridLeftColumn:{borderRight:"5px",borderRightStyle:"solid",borderRightColor:e.palette.primary.main},propertyGridItem:{borderTop:"5px",borderTopStyle:"solid",borderTopColor:e.palette.primary.main}}}));function Dt(e){var t=Et(e);return Object(Q.jsxs)("div",{className:t.root,children:[Object(Q.jsx)(Tt,{}),Object(Q.jsx)("div",{className:t.toolbarMargin}),Object(Q.jsxs)(u.a,{container:!0,spacing:0,children:[Object(Q.jsxs)(u.a,{className:t.gridLeftColumn,container:!0,xs:3,direction:"column",spacing:0,children:[Object(Q.jsx)(u.a,{item:!0,style:{height:"40vh",overflow:"auto"},children:Object(Q.jsx)(ue,{})}),Object(Q.jsx)(u.a,{item:!0,className:t.propertyGridItem,style:{height:"40vh",overflow:"auto"},children:Object(Q.jsx)(Te,{})})]}),Object(Q.jsx)(u.a,{item:!0,xs:9,className:t.workingArea,children:Object(Q.jsx)(Le,{})})]})]})}c.a.render(Object(Q.jsx)(i.a.StrictMode,{children:Object(Q.jsx)(Dt,{})}),document.getElementById("root"))}},[[147,1,2]]]);
//# sourceMappingURL=main.8d4d614a.chunk.js.map